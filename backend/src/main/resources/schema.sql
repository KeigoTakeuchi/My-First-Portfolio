CREATE TABLE accounts (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR(255) UNIQUE NOT NULL,
	hashed_password VARCHAR(255) NOT NULL,
	display_name VARCHAR(50) UNIQUE NULL,
	authority VARCHAR(20) NOT NULL CHECK (authority IN ('ADMIN','USER','UNKNOWN')),
	created_at TIMESTAMP NOT NULL,
	updated_at TIMESTAMP NOT NULL,
	deleted_at TIMESTAMP
);

CREATE TABLE images (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	account_id INTEGER NOT NULL,
	name VARCHAR(100) NOT NULL,
	file_path VARCHAR(300) NOT NULL,
	created_at TIMESTAMP NOT NULL,
	updated_at TIMESTAMP NOT NULL,
	FOREIGN KEY (account_id) REFERENCES accounts(id)
);

CREATE TABLE messages (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	account_id INTEGER NOT NULL,
	title VARCHAR(100),
	content VARCHAR(300),
	created_at TIMESTAMP NOT NULL,
	updated_at TIMESTAMP NOT NULL,
	FOREIGN KEY (account_id) REFERENCES accounts(id)
);

CREATE TABLE post_images (
	image_id INTEGER NOT NULL,
	message_id INTEGER NOT NULL,
	PRIMARY KEY (image_id,message_id),
	FOREIGN KEY (image_id) REFERENCES images(id),
	FOREIGN KEY (message_id) REFERENCES messages(id)
);